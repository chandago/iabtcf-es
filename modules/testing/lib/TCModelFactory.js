"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var core_1=require("@iabtcf/core"),makeRandomInt_1=require("./makeRandomInt"),GVLFactory_1=require("./GVLFactory"),TCModelFactory=function(){function e(){}return e.noGVL=function(e){var n=GVLFactory_1.GVLFactory.getLatest();e||(e=new core_1.TCModel),e.cmpId=makeRandomInt_1.makeRandomInt(2,100),e.cmpVersion=makeRandomInt_1.makeRandomInt(1,10),e.consentScreen=makeRandomInt_1.makeRandomInt(1,5),e.isServiceSpecific=!!makeRandomInt_1.makeRandomInt(0,1),e.vendorListVersion=makeRandomInt_1.makeRandomInt(1,n.vendorListVersion);var t=0,o=makeRandomInt_1.makeRandomInt(1,core_1.TCModel.consentLanguages.size);core_1.TCModel.consentLanguages.forEach((function(n){++t===o&&(e.consentLanguage=n)})),e.publisherCountryCode=String.fromCharCode(makeRandomInt_1.makeRandomInt(65,90))+String.fromCharCode(makeRandomInt_1.makeRandomInt(65,90));var a=(new Date).getTime();e.created=new Date(makeRandomInt_1.makeRandomInt(1576883249,a)),e.lastUpdated=new Date(makeRandomInt_1.makeRandomInt(e.created.getTime(),a));var r={purposes:["publisherConsents","publisherLegitimateInterests","purposeConsents","purposeLegitimateInterests"],specialFeatures:["specialFeatureOptins"],vendors:["vendorConsents","vendorLegitimateInterests","vendorsAllowed","vendorsDisclosed"]};return Object.keys(r).forEach((function(t){Object.keys(n[t]).map((function(e){return+e})).forEach((function(n){r[t].forEach((function(t){3!==makeRandomInt_1.makeRandomInt(1,4)&&e[t].set(n)}))}))})),e},e.addPublisherRestrictions=function(e){return e.gvl||(e.gvl=GVLFactory_1.GVLFactory.getLatest()),Object.keys(e.gvl.vendors).forEach((function(n){var t=e.gvl.vendors[n];if(t.flexiblePurposes.length){var o=t.flexiblePurposes[makeRandomInt_1.makeRandomInt(0,t.flexiblePurposes.length-1)],a=t.purposes.includes(o),r=void 0;r=1===makeRandomInt_1.makeRandomInt(0,1)?new core_1.PurposeRestriction(o,core_1.RestrictionType.NOT_ALLOWED):a?new core_1.PurposeRestriction(o,core_1.RestrictionType.REQUIRE_LI):new core_1.PurposeRestriction(o,core_1.RestrictionType.REQUIRE_CONSENT),e.publisherRestrictions.add(+n,r)}})),e},e.withGVL=function(){var e=this.noGVL();return e.gvl=GVLFactory_1.GVLFactory.getLatest(),e},e}();exports.TCModelFactory=TCModelFactory;